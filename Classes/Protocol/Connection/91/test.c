#include "d3des.h"
#include "DES3.h"
#include<string.h>
#include<stdio.h>
#include"EncryptPwd.h"

void PRINT(char *msg,unsigned char *yy)
{
		printf("%s[",msg);
		int i;
		for(i=0;i<24;i++) {
			printf("%02x ",yy[i]);
		}
		printf("]\n");
}


//int main(int argc,char *argv[])
//{
	
/*	unsigned char e_key[24] = {0xee, 0xda, 0x11, 0x16, 0x58, 0x5e, 0x30, 0x86, 0x33, 0x8a, 0x05, 0x56, 0xdc, 0x49, 0xb5, 0xea, 0x3d, 0x68, 0x3f, 0x76, 0x99, 0x9b, 0x49, 0x35};
		//{0x17,0x23, 0xb8, 0xa5, 0x79, 0xec, 0xb0, 0x4d, 0xb4, 0x35, 0xa0, 0x0a, 0x78,0xa6, 0x00, 0xbc, 0x94, 0x00, 0x0a, 0x96, 0xf0, 0xa5, 0x10, 0xbe}//{0xee,0xda,0x11,0x16,0x58,0x5e,0x30,0x86,0x33,0x8a,0x05,0x56,0xdc,0x49,0xb5,0xea,0x3d,0x68,0x3f,0x76,0x99,0x9b,0x49,0x35};

	unsigned char buff[512] = {0x36, 0x00, 0x74, 0x65, 0x73, 0x30, 0x30, 0x32, 0x00, 0x31, 0x00, 0x61, 0x70, 0x70, 0x73, 0x76, 0x72, 0x38, 0x31, 0x31, 0x00};
		//{0x36,0x00,0x74,0x65,0x73,0x30,0x30,0x32,0x00,0x31,0x00,0x61,0x70,0x70,0x73,0x76,0x72,0x38,0x31,0x31,0x00};

	unsigned char buff1[512];
	unsigned char buff2[512];

	memset(buff1,'\0',sizeof(buff1));
	memset(buff2,'\0',sizeof(buff2));


	
	
	int length = 0;
	int len = 0;
	//1.使用3key的DES3
	SetDES3Param(e_key, DES3_3KEY_ENCRYPT, PAD_PKCS_7, DES_CBC);
	Run_Des(buff, 21, buff1, &length);
	PRINT("Out:",buff1);
	SetDES3Param(e_key, DES3_3KEY_DECRYPT, PAD_PKCS_7, DES_CBC);
	Run_Des(buff1, length, buff2, &len);
	PRINT("Decryt", buff2);
	
	//2.使用2KEY的DES3
	SetDES3Param(e_key, DES3_2KEY_ENCRYPT, PAD_PKCS_7, DES_CBC);
	Run_Des(buff, 21, buff1, &length);
	PRINT("Out:",buff1);
	SetDES3Param(e_key, DES3_2KEY_DECRYPT, PAD_PKCS_7, DES_CBC);
	Run_Des(buff1, length, buff2, &len);
	PRINT("Decryt", buff2);
	
	
	//3.使用1key的des
	SetDES3Param(e_key, DES_1KEY_ENCRYPT, PAD_PKCS_7, DES_CBC);
	Run_Des(buff, 21, buff1, &length);
	PRINT("Out:",buff1);
	SetDES3Param(e_key, DES_1KEY_DECRYPT, PAD_PKCS_7, DES_CBC);
	Run_Des(buff1, length, buff2, &len);
	PRINT("Decryt", buff2);*/
	
	//char* pwd = "92345678";
	//char* pstr = EncryptPwd(pwd);
	//printf("result is %s",pstr);
	

//}
